general:
  branches:
    ignore:
      - gh-pages
machine:
  node:
    version: 5.1.0
  ruby:
    version: 2.2.3
  environment:
    GO_VERSION: $(node -p 'require("./config.json").versions.go')
  post:
    - mkdir -p ~/downloads
    - curl https://storage.googleapis.com/golang/go${GO_VERSION}.linux-amd64.tar.gz -o ~/downloads/go${GO_VERSION}.linux-amd64.tar.gz
    - sudo rm -rf /usr/local/go
    - sudo tar xvzf -C /usr/local ~/downloads/go${GO_VERSION}.linux-amd64.tar.gz
deployment:
  production:
    branch: master
    commands:
      - git config --global user.name "CircleCI"
      - git config --global user.email "sayhi@circleci.com"
      - PRODUCTION=1 npm run publish-html
